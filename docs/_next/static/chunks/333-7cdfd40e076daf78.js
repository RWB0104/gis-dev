"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[333],{23744:function(e,t,i){var s=i(13767);t.Z=void 0;var n=s(i(41032)),r=i(39926),o=(0,n.default)((0,r.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");t.Z=o},50878:function(e,t,i){var s=i(13767);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(i(41032)),r=i(39926),o=(0,n.default)((0,r.jsx)("path",{d:"M20.94 11c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}),"LocationSearching");t.default=o},69147:function(e,t,i){i.d(t,{ZP:function(){return N}});var s=i(92857),n=i(75682),r=i(57132),o=i(59677);class h extends s.ZP{constructor(e,t,i){super(),void 0!==i&&void 0===t?this.setFlatCoordinates(i,e):(t=t||0,this.setCenterAndRadius(e,t,i))}clone(){let e=new h(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,s){let n=this.flatCoordinates,r=e-n[0],o=t-n[1],h=r*r+o*o;if(h<s){if(0===h)for(let e=0;e<this.stride;++e)i[e]=n[e];else{let e=this.getRadius()/Math.sqrt(h);i[0]=n[0]+e*r,i[1]=n[1]+e*o;for(let e=2;e<this.stride;++e)i[e]=n[e]}return i.length=this.stride,h}return s}containsXY(e,t){let i=this.flatCoordinates,s=e-i[0],n=t-i[1];return s*s+n*n<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){let t=this.flatCoordinates,i=t[this.stride]-t[0];return(0,n.T9)(t[0]-i,t[1]-i,t[0]+i,t[1]+i,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){let e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){let t=this.getExtent();if((0,n.kK)(e,t)){let t=this.getCenter();return e[0]<=t[0]&&e[2]>=t[0]||e[1]<=t[1]&&e[3]>=t[1]||(0,n.H6)(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){let t=this.stride,i=this.flatCoordinates[t]-this.flatCoordinates[0],s=e.slice();s[t]=s[0]+i;for(let i=1;i<t;++i)s[t+i]=e[i];this.setFlatCoordinates(this.layout,s),this.changed()}setCenterAndRadius(e,t,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);let s=this.flatCoordinates,n=(0,r.IG)(s,0,e,this.stride);s[n++]=s[0]+t;for(let e=1,t=this.stride;e<t;++e)s[n++]=s[e];s.length=n,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){let i=this.getCenter(),s=this.getStride();this.setCenter((0,o.U1)(i,0,i.length,s,e,t,i)),this.changed()}}h.prototype.transform;var a=i(82303),l=i(11192),d=i(20584),u=i(69241),g=i(71495),_=i(592),c=i(46835),f=i(87623),m=i(94415),p=i(51431),y=i(8849),C=i(31492),x=i(27354),v=i(87186),P=i(14423),F=i(5264),S=i(93040),T=i(42359),E=i(87524),w=i(57033),M=i(85810),L=i(94027);let k={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class D extends a.ZP{constructor(e,t){super(e),this.feature=t}}function I(e,t){return(0,E.bI)(e[0],e[1],t[0],t[1])}function G(e,t){let i=e.length;return t<0?e[t+i]:t>=i?e[t-i]:e[t]}function Z(e,t,i){let s,n;t<i?(s=t,n=i):(s=i,n=t);let r=Math.ceil(s),o=Math.floor(n);if(r>o)return I(O(e,s),O(e,n));let h=0;s<r&&(h+=I(O(e,s),G(e,r))),o<n&&(h+=I(G(e,o),O(e,n)));for(let t=r;t<o-1;++t)h+=I(G(e,t),G(e,t+1));return h}let b={index:-1,endIndex:NaN};function R(e,t,i,s){let n=e[0],r=e[1];for(let e=0,o=t.length-1;e<o;++e){let o=V(n,r,t[e],t[e+1]);if(0===o.squaredDistance){let n=e+o.along;s.push({coordinates:t,ring:i,startIndex:n,endIndex:n});return}}}let A={along:0,squaredDistance:0};function V(e,t,i,s){let n=i[0],r=i[1],o=s[0],h=s[1],a=o-n,l=h-r,d=0,u=n,g=r;return(0!==a||0!==l)&&(d=(0,E.uZ)(((e-n)*a+(t-r)*l)/(a*a+l*l),0,1),u+=a*d,g+=l*d),A.along=d,A.squaredDistance=(0,E.FH)((0,E.bI)(e,t,u,g),10),A}function O(e,t){let i=e.length,s=Math.floor(t),n=t-s;s>=i?s-=i:s<0&&(s+=i);let r=s+1;r>=i&&(r-=i);let o=e[s],h=o[0],a=o[1],l=e[r],d=l[0]-h,u=l[1]-a;return[h+d*n,a+u*n]}class B extends x.Z{constructor(e){e.stopDown||(e.stopDown=S.Dv),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=function(e){switch(e){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw Error("Invalid type: "+e)}}(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:S.uX,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let t=e.geometryFunction;if(!t){let e=this.mode_;if("Circle"===e)t=function(e,t,i){let s=t||new h([NaN,NaN]),n=(0,L.Vs)(e[0],i),r=(0,M.bI)(n,(0,L.Vs)(e[e.length-1],i));s.setCenterAndRadius(n,Math.sqrt(r),this.geometryLayout_);let o=(0,L.Cs)();return o&&s.transform(i,o),s};else{let i;"Point"===e?i=C.Z:"LineString"===e?i=_.Z:"Polygon"===e&&(i=v.ZP),t=function(t,s,n){return s?"Polygon"===e?t[0].length?s.setCoordinates([t[0].concat([t[0][0]])],this.geometryLayout_):s.setCoordinates([],this.geometryLayout_):s.setCoordinates(t,this.geometryLayout_):s=new i(t,this.geometryLayout_),s}}}this.geometryFunction_=t,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new P.Z({source:new F.Z({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:function(){let e=(0,w.Ly)();return function(t,i){return e[t.getGeometry().getType()]}}(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:T.rM,this.freehandCondition_,e.freehand?this.freehandCondition_=T.Bx:this.freehandCondition_=e.freehandCondition?e.freehandCondition:T.vY,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(g.Z.ACTIVE,this.updateState_)}setTrace(e){let t;t=e?!0===e?T.Bx:e:T.Fi,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===l.Z.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);let t=e.type===f.Z.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&e.type===f.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===f.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===f.Z.POINTERDOWN?i=!1:t&&2>this.getPointerCount()?(i=e.type===f.Z.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===f.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===f.Z.DBLCLICK&&(i=!1),super.handleEvent(e)&&i}handleDownEvent(e){return(this.shouldHandle_=!this.freehand_,this.freehand_)?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new c.Z(f.Z.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}let t=this.getMap(),i=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),s=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=(0,n.hI)([i,s]),o=this.traceSource_.getFeaturesInExtent(r);if(0===o.length)return;let h=function(e,t){let i=[];for(let s=0;s<t.length;++s)!function e(t,i,s){if(i instanceof _.Z){R(t,i.getCoordinates(),!1,s);return}if(i instanceof m.Z){let e=i.getCoordinates();for(let i=0,n=e.length;i<n;++i)R(t,e[i],!1,s);return}if(i instanceof v.ZP){let e=i.getCoordinates();for(let i=0,n=e.length;i<n;++i)R(t,e[i],!0,s);return}if(i instanceof y.Z){let e=i.getCoordinates();for(let i=0,n=e.length;i<n;++i){let n=e[i];for(let e=0,i=n.length;e<i;++e)R(t,n[e],!0,s)}return}if(i instanceof u.Z){let n=i.getGeometries();for(let i=0;i<n.length;++i)e(t,n[i],s);return}}(e,t[s].getGeometry(),i);return i}(e.coordinate,o);h.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:h,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){let i=e.startIndex<=e.endIndex;i===e.startIndex<=t?i&&t>e.endIndex||!i&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(i&&t<e.endIndex||!i&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let i=0;if(e<t){let s=Math.floor(t);s===t&&(s-=1),i=s-Math.ceil(e)+1}else{let s=Math.ceil(t);s===t&&(s+=1),i=Math.floor(e)-s+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(e,t,i){if(t===i)return;let s=[];if(t<i){let n=Math.ceil(t),r=Math.floor(i);r===i&&(r-=1);for(let t=n;t<=r;++t)s.push(G(e.coordinates,t))}else{let n=Math.floor(t),r=Math.ceil(i);r===i&&(r+=1);for(let t=n;t>=r;--t)s.push(G(e.coordinates,t))}s.length&&this.appendCoordinates(s)}updateTrace_(e){let t=this.traceState_;if(!t.active||-1===t.targetIndex&&(0,M.TE)(t.startPx,e.pixel)<this.snapTolerance_)return;let i=function(e,t,i,s){let n=e[0],r=e[1],o=1/0,h=-1,a=NaN;for(let e=0;e<t.targets.length;++e){let i;let s=t.targets[e],l=s.coordinates,d=1/0;for(let e=0;e<l.length-1;++e){let t=V(n,r,l[e],l[e+1]);t.squaredDistance<d&&(d=t.squaredDistance,i=e+t.along)}d<o&&(o=d,s.ring&&t.targetIndex===e&&(s.endIndex>s.startIndex?i<s.startIndex&&(i+=l.length):s.endIndex<s.startIndex&&i>s.startIndex&&(i-=l.length)),a=i,h=e)}let l=t.targets[h],d=l.ring;if(t.targetIndex===h&&d){let e=O(l.coordinates,a),n=i.getPixelFromCoordinate(e);(0,M.TE)(n,t.startPx)>s&&(d=!1)}if(d){let e=l.coordinates,t=e.length,i=l.startIndex,s=a;if(i<s){let n=Z(e,i,s);Z(e,i,s-t)<n&&(a-=t)}else{let n=Z(e,i,s);Z(e,i,s+t)<n&&(a+=t)}}return b.index=h,b.endIndex=a,b}(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==i.index){if(-1!==t.targetIndex){let e=t.targets[t.targetIndex];this.removeTracedCoordinates_(e.startIndex,e.endIndex)}let e=t.targets[i.index];this.addTracedCoordinates_(e,e.startIndex,i.endIndex)}else{let e=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(e,i.endIndex)}t.targetIndex=i.index;let s=t.targets[t.targetIndex];s.endIndex=i.endIndex;let n=O(s.coordinates,s.endIndex),r=this.getMap().getPixelFromCoordinate(n);e.coordinate=n,e.pixel=[Math.round(r[0]),Math.round(r[1])]}handleUpEvent(e){let t=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);let i=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){let s=!this.finishCoordinate_;s&&this.startDrawing_(e.coordinate),!s&&this.freehand_?this.finishDrawing():this.freehand_||s&&"Point"!==this.mode_||(this.atFinish_(e.pixel,i)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){let t=this.downPx_,i=e.pixel,s=t[0]-i[0],n=t[1]-i[1],r=s*s+n*n;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let i=!1;if(this.sketchFeature_){let s=!1,n=[this.finishCoordinate_],r=this.mode_;if("Point"===r)i=!0;else if("Circle"===r)i=2===this.sketchCoords_.length;else if("LineString"===r)s=!t&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===r){let e=this.sketchCoords_;s=e[0].length>this.minPoints_,n=[e[0][0],e[0][e[0].length-2]],n=t?[e[0][0]]:[e[0][0],e[0][e[0].length-2]]}if(s){let t=this.getMap();for(let s=0,r=n.length;s<r;s++){let r=n[s],o=t.getPixelFromCoordinate(r),h=e[0]-o[0],a=e[1]-o[1];if(i=Math.sqrt(h*h+a*a)<=(this.freehand_?1:this.snapTolerance_)){this.finishCoordinate_=r;break}}}}return i}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new d.Z(new C.Z(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new d.Z);let t=e.getLinearRing(0),i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),i.changed()):(i=new _.Z(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(e){let t=this.getMap().getView().getProjection(),i=(0,s.tP)(this.geometryLayout_);for(;e.length<i;)e.push(0);this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new d.Z(new _.Z(this.sketchLineCoords_)));let n=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new d.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new D(k.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){let t,i;let n=this.getMap(),r=this.sketchFeature_.getGeometry(),o=n.getView().getProjection(),h=(0,s.tP)(this.geometryLayout_);for(;e.length<h;)e.push(0);"Point"===this.mode_?i=this.sketchCoords_:"Polygon"===this.mode_?(i=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(n.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):i=(t=this.sketchCoords_)[t.length-1],i[0]=e[0],i[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,o),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),"Polygon"===r.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){let t,i;let s=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),r=this.mode_;return("LineString"===r||"Circle"===r?(this.finishCoordinate_=e.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():t=!0),i.push(e.slice()),this.geometryFunction_(i,s,n)):"Polygon"===r&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():t=!0),i.push(e.slice()),t&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,s,n)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),t)?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;let t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),s=this.mode_;for(let n=0;n<e;++n){let e;if("LineString"===s||"Circle"===s){if((e=this.sketchCoords_).splice(-2,1),e.length>=2){this.finishCoordinate_=e[e.length-2].slice();let t=this.finishCoordinate_.slice();e[e.length-1]=t,this.createOrUpdateSketchPoint_(t)}this.geometryFunction_(e,t,i),"Polygon"===t.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if("Polygon"===s){(e=this.sketchCoords_[0]).splice(-2,1);let s=this.sketchLine_.getGeometry();if(e.length>=2){let t=e[e.length-2].slice();e[e.length-1]=t,this.createOrUpdateSketchPoint_(t)}s.setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t,i)}if(1===e.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){let e=this.abortDrawing_();if(!e)return null;let t=this.sketchCoords_,i=e.getGeometry(),s=this.getMap().getView().getProjection();return"LineString"===this.mode_?(t.pop(),this.geometryFunction_(t,i,s)):"Polygon"===this.mode_&&(t[0].pop(),this.geometryFunction_(t,i,s),t=i.getCoordinates()),"MultiPoint"===this.type_?e.setGeometry(new p.Z([t])):"MultiLineString"===this.type_?e.setGeometry(new m.Z([t])):"MultiPolygon"===this.type_&&e.setGeometry(new y.Z([t])),this.dispatchEvent(new D(k.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;let e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){let e=this.abortDrawing_();e&&this.dispatchEvent(new D(k.DRAWABORT,e))}appendCoordinates(e){let t;let i=this.mode_,s=!this.sketchFeature_;if(s&&this.startDrawing_(e[0]),"LineString"===i||"Circle"===i)t=this.sketchCoords_;else{if("Polygon"!==i)return;t=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}s&&t.shift(),t.pop();for(let t=0;t<e.length;t++)this.addToDrawing_(e[t]);let n=e[e.length-1];this.sketchFeature_=this.addToDrawing_(n),this.modifyDrawing_(n)}extend(e){let t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();let i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new d.Z(new C.Z(i)),this.updateSketchFeatures_(),this.dispatchEvent(new D(k.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){let e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);let t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){let e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)}}var N=B},67656:function(e,t,i){var s=i(35234),n=i(35471),r=i(82303),o=i(11192),h=i(20584),a=i(87623),l=i(31492),d=i(27354),u=i(87988),g=i(24235),_=i(14423),c=i(5264),f=i(42359),m=i(75682),p=i(85810),y=i(57033),C=i(97099),x=i(87186),v=i(94027),P=i(92437);let F=[0,0,0,0],S=[],T={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class E extends r.ZP{constructor(e,t,i){super(e),this.features=t,this.mapBrowserEvent=i}}class w extends d.Z{constructor(e){let t;if(super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:f.Xp,this.defaultDeleteCondition_=function(e){return(0,f.Ko)(e)&&(0,f.Kf)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:f.Bx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new u.Z,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new _.Z({source:new c.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:function(){let e=(0,y.Ly)();return function(t,i){return e.Point}}(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null,e.features?t=e.features:e.source&&(this.source_=e.source,t=new s.Z(this.source_.getFeatures()),this.source_.addEventListener(g.Z.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(g.Z.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(n.Z.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(n.Z.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=void 0===e.snapToPointer?!this.hitDetection_:e.snapToPointer}addFeature_(e){let t=e.getGeometry();if(t){let i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}let i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),e.addEventListener(o.Z.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new s.Z;let i=this.featuresBeingModified_.getArray();for(let e=0,s=t.length;e<s;++e){let s=t[e];for(let e=0,t=s.length;e<t;++e){let t=s[e].feature;t&&!i.includes(t)&&this.featuresBeingModified_.push(t)}}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new E(T.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(o.Z.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){let t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e){let s=i[e];for(let e=this.dragSegments_.length-1;e>=0;--e)this.dragSegments_[e][0]===s&&this.dragSegments_.splice(e,1);t.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){let t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){let i=t.getCoordinates();this.rBush_.insert(t.getExtent(),{feature:e,geometry:t,segment:[i,i]})}writeMultiPointGeometry_(e,t){let i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){let n=i[s],r={feature:e,geometry:t,depth:[s],index:s,segment:[n,n]};this.rBush_.insert(t.getExtent(),r)}}writeLineStringGeometry_(e,t){let i=t.getCoordinates();for(let s=0,n=i.length-1;s<n;++s){let n=i.slice(s,s+2),r={feature:e,geometry:t,index:s,segment:n};this.rBush_.insert((0,m.hI)(n),r)}}writeMultiLineStringGeometry_(e,t){let i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){let n=i[s];for(let i=0,r=n.length-1;i<r;++i){let r=n.slice(i,i+2),o={feature:e,geometry:t,depth:[s],index:i,segment:r};this.rBush_.insert((0,m.hI)(r),o)}}}writePolygonGeometry_(e,t){let i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){let n=i[s];for(let i=0,r=n.length-1;i<r;++i){let r=n.slice(i,i+2),o={feature:e,geometry:t,depth:[s],index:i,segment:r};this.rBush_.insert((0,m.hI)(r),o)}}}writeMultiPolygonGeometry_(e,t){let i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){let n=i[s];for(let i=0,r=n.length;i<r;++i){let r=n[i];for(let n=0,o=r.length-1;n<o;++n){let o=r.slice(n,n+2),h={feature:e,geometry:t,depth:[i,s],index:n,segment:o};this.rBush_.insert((0,m.hI)(o),h)}}}}writeCircleGeometry_(e,t){let i=t.getCenter(),s={feature:e,geometry:t,index:0,segment:[i,i]},n={feature:e,geometry:t,index:1,segment:[i,i]},r=[s,n];s.featureSegments=r,n.featureSegments=r,this.rBush_.insert((0,m.HK)(i),s);let o=t,h=(0,v.Cs)();if(h&&this.getMap()){let e=this.getMap().getView().getProjection();o=o.clone().transform(h,e),o=(0,x.Bb)(o).transform(e,h)}this.rBush_.insert(o.getExtent(),n)}writeGeometryCollectionGeometry_(e,t){let i=t.getGeometriesArray();for(let t=0;t<i.length;++t){let s=i[t];(0,this.SEGMENT_WRITERS_[s.getType()])(e,s)}}createOrUpdateVertexFeature_(e,t,i){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(e):(s=new h.Z(new l.Z(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",t),s.set("geometries",i),s}handleEvent(e){let t;return!e.originalEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=a.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=e.type==a.Z.SINGLECLICK&&!!this.ignoreNextSingleClick_||this.removePoint()),e.type==a.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);let t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],s=[];for(let n=0,r=this.dragSegments_.length;n<r;++n){let r;let o=this.dragSegments_[n],h=o[0],a=h.feature;i.includes(a)||i.push(a);let l=h.geometry;s.includes(l)||s.push(l);let d=h.depth,u=h.segment,g=o[1];for(;t.length<l.getStride();)t.push(u[g][t.length]);switch(l.getType()){case"Point":r=t,u[0]=t,u[1]=t;break;case"MultiPoint":(r=l.getCoordinates())[h.index]=t,u[0]=t,u[1]=t;break;case"LineString":(r=l.getCoordinates())[h.index+g]=t,u[g]=t;break;case"MultiLineString":case"Polygon":(r=l.getCoordinates())[d[0]][h.index+g]=t,u[g]=t;break;case"MultiPolygon":(r=l.getCoordinates())[d[1]][d[0]][h.index+g]=t,u[g]=t;break;case"Circle":if(u[0]=t,u[1]=t,0===h.index)this.changingFeature_=!0,l.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;let i=e.map.getView().getProjection(),s=(0,p.TE)((0,v.Vs)(l.getCenter(),i),(0,v.Vs)(t,i)),n=(0,v.Cs)();if(n){let e=l.clone().transform(n,i);e.setRadius(s),s=e.transform(i,n).getRadius()}l.setRadius(s),this.changingFeature_=!1}}r&&this.setGeometryCoordinates_(l,r)}this.createOrUpdateVertexFeature_(t,i,s)}handleDownEvent(e){if(!this.condition_(e))return!1;let t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;let i=this.vertexFeature_;if(i){let s=e.map.getView().getProjection(),n=[],r=i.getGeometry().getCoordinates(),o=(0,m.hI)([r]),h=this.rBush_.getInExtent(o),a={};h.sort(M);for(let i=0,o=h.length;i<o;++i){let o=h[i],l=o.segment,d=(0,P.sq)(o.geometry),u=o.depth;if(u&&(d+="-"+u.join("-")),a[d]||(a[d]=[,,]),"Circle"===o.geometry.getType()&&1===o.index){let e=k(t,o,s);(0,p.fS)(e,r)&&!a[d][0]&&(this.dragSegments_.push([o,0]),a[d][0]=o);continue}if((0,p.fS)(l[0],r)&&!a[d][0]){this.dragSegments_.push([o,0]),a[d][0]=o;continue}if((0,p.fS)(l[1],r)&&!a[d][1]){if(a[d][0]&&0===a[d][0].index){let e=o.geometry.getCoordinates();switch(o.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":e=e[u[1]];case"Polygon":if(o.index!==e[u[0]].length-2)continue}}this.dragSegments_.push([o,1]),a[d][1]=o;continue}(0,P.sq)(l) in this.vertexSegments_&&!a[d][0]&&!a[d][1]&&this.insertVertexCondition_(e)&&n.push(o)}n.length&&this.willModifyFeatures_(e,[n]);for(let e=n.length-1;e>=0;--e)this.insertVertex_(n[e],r)}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){let i=this.dragSegments_[t][0],s=i.geometry;if("Circle"===s.getType()){let t=s.getCenter(),n=i.featureSegments[0],r=i.featureSegments[1];n.segment[0]=t,n.segment[1]=t,r.segment[0]=t,r.segment[1]=t,this.rBush_.update((0,m.HK)(t),n);let o=s,h=(0,v.Cs)();if(h){let t=e.map.getView().getProjection();o=o.clone().transform(h,t),o=(0,x.Bb)(o).transform(t,h)}this.rBush_.update(o.getExtent(),r)}else this.rBush_.update((0,m.hI)(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new E(T.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}handlePointerAtPixel_(e,t,i){let s,n;let r=i||t.getCoordinateFromPixel(e),o=t.getView().getProjection();if(this.hitDetection_){let i="object"==typeof this.hitDetection_?e=>e===this.hitDetection_:void 0;t.forEachFeatureAtPixel(e,(e,t,i)=>{i&&"Point"===i.getType()&&(i=new l.Z((0,v.lO)(i.getCoordinates(),o)));let r=i||e.getGeometry();if(e instanceof h.Z&&this.features_.getArray().includes(e)){n=r;let t=e.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:e,geometry:n,segment:[t,t]}]}return!0},{layerFilter:i})}if(!s){let e=(0,v.dY)((0,m.HK)(r,F),o),i=t.getView().getResolution()*this.pixelTolerance_,n=(0,v.Fj)((0,m.f3)(e,i,F),o);s=this.rBush_.getInExtent(n)}if(s&&s.length>0){let i=s.sort(function(e,t){return L(r,e,o)-L(r,t,o)})[0],h=i.segment,a=k(r,i,o),l=t.getPixelFromCoordinate(a),d=(0,p.TE)(e,l);if(n||d<=this.pixelTolerance_){let e={};if(e[(0,P.sq)(h)]=!0,this.snapToPointer_||(this.delta_[0]=a[0]-r[0],this.delta_[1]=a[1]-r[1]),"Circle"===i.geometry.getType()&&1===i.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(a,[i.feature],[i.geometry]);else{let n=t.getPixelFromCoordinate(h[0]),r=t.getPixelFromCoordinate(h[1]),o=(0,p.bI)(l,n),u=(0,p.bI)(l,r);d=Math.sqrt(Math.min(o,u)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(a=o>u?h[1]:h[0]),this.createOrUpdateVertexFeature_(a,[i.feature],[i.geometry]);let g={};g[(0,P.sq)(i.geometry)]=!0;for(let t=1,i=s.length;t<i;++t){let i=s[t].segment;if((0,p.fS)(h[0],i[0])&&(0,p.fS)(h[1],i[1])||(0,p.fS)(h[0],i[1])&&(0,p.fS)(h[1],i[0])){let n=(0,P.sq)(s[t].geometry);n in g||(g[n]=!0,e[(0,P.sq)(i)]=!0)}else break}}this.vertexSegments_=e;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){let i;let s=e.segment,n=e.feature,r=e.geometry,o=e.depth,h=e.index;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case"MultiLineString":case"Polygon":(i=r.getCoordinates())[o[0]].splice(h+1,0,t);break;case"MultiPolygon":(i=r.getCoordinates())[o[1]][o[0]].splice(h+1,0,t);break;case"LineString":(i=r.getCoordinates()).splice(h+1,0,t);break;default:return}this.setGeometryCoordinates_(r,i);let a=this.rBush_;a.remove(e),this.updateSegmentIndices_(r,h,o,1);let l={segment:[s[0],t],feature:n,geometry:r,depth:o,index:h};a.insert((0,m.hI)(l.segment),l),this.dragSegments_.push([l,1]);let d={segment:[t,s[1]],feature:n,geometry:r,depth:o,index:h+1};a.insert((0,m.hI)(d.segment),d),this.dragSegments_.push([d,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=a.Z.POINTERDRAG){let e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);let t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new E(T.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}removeVertex_(){let e,t,i,s,n,r,o,h,a,l,d;let u=this.dragSegments_,g={},_=!1;for(n=u.length-1;n>=0;--n)l=(i=u[n])[0],d=(0,P.sq)(l.feature),l.depth&&(d+="-"+l.depth.join("-")),d in g||(g[d]={}),0===i[1]?(g[d].right=l,g[d].index=l.index):1==i[1]&&(g[d].left=l,g[d].index=l.index+1);for(d in g){switch(a=g[d].right,o=g[d].left,(h=(r=g[d].index)-1)<0&&(h=0),e=t=(s=(l=void 0!==o?o:a).geometry).getCoordinates(),_=!1,s.getType()){case"MultiLineString":t[l.depth[0]].length>2&&(t[l.depth[0]].splice(r,1),_=!0);break;case"LineString":t.length>2&&(t.splice(r,1),_=!0);break;case"MultiPolygon":e=e[l.depth[1]];case"Polygon":(e=e[l.depth[0]]).length>4&&(r==e.length-1&&(r=0),e.splice(r,1),_=!0,0===r&&(e.pop(),e.push(e[0]),h=e.length-1))}if(_){this.setGeometryCoordinates_(s,t);let e=[];if(void 0!==o&&(this.rBush_.remove(o),e.push(o.segment[0])),void 0!==a&&(this.rBush_.remove(a),e.push(a.segment[1])),void 0!==o&&void 0!==a){let t={depth:l.depth,feature:l.feature,geometry:l.geometry,index:h,segment:e};this.rBush_.insert((0,m.hI)(t.segment),t)}this.updateSegmentIndices_(s,r,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),u.length=0}}return _}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,i,s){this.rBush_.forEachInExtent(e.getExtent(),function(n){n.geometry===e&&(void 0===i||void 0===n.depth||(0,C.fS)(n.depth,i))&&n.index>t&&(n.index+=s)})}}function M(e,t){return e.index-t.index}function L(e,t,i){let s=t.geometry;if("Circle"===s.getType()){let n=s;if(1===t.index){let t=(0,v.Cs)();t&&(n=n.clone().transform(t,i));let s=Math.sqrt((0,p.bI)(n.getCenter(),(0,v.Vs)(e,i)))-n.getRadius();return s*s}}let n=(0,v.Vs)(e,i);return S[0]=(0,v.Vs)(t.segment[0],i),S[1]=(0,v.Vs)(t.segment[1],i),(0,p.Bs)(n,S)}function k(e,t,i){let s=t.geometry;if("Circle"===s.getType()&&1===t.index){let t=s,n=(0,v.Cs)();return n&&(t=t.clone().transform(n,i)),(0,v.lO)(t.getClosestPoint((0,v.Vs)(e,i)),i)}let n=(0,v.Vs)(e,i);return S[0]=(0,v.Vs)(t.segment[0],i),S[1]=(0,v.Vs)(t.segment[1],i),(0,v.lO)((0,p.oL)(n,S),i)}t.Z=w},34:function(e,t,i){var s=i(35234),n=i(35471),r=i(82303),o=i(20584),h=i(39627),a=i(14423),l=i(93040),d=i(29566),u=i(57033),g=i(97099),_=i(92437),c=i(42359);let f={SELECT:"select"};class m extends r.ZP{constructor(e,t,i,s){super(e),this.selected=t,this.deselected=i,this.mapBrowserEvent=s}}let p={};class y extends h.ZP{constructor(e){let t;if(super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:c.Kf,this.addCondition_=e.addCondition?e.addCondition:c.Fi,this.removeCondition_=e.removeCondition?e.removeCondition:c.Fi,this.toggleCondition_=e.toggleCondition?e.toggleCondition:c.vY,this.multi_=!!e.multi&&e.multi,this.filter_=e.filter?e.filter:l.uX,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=void 0!==e.style?e.style:function(){let e=(0,u.Ly)();return(0,g.l7)(e.Polygon,e.LineString),(0,g.l7)(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(),this.features_=e.features||new s.Z,e.layers){if("function"==typeof e.layers)t=e.layers;else{let i=e.layers;t=function(e){return i.includes(e)}}}else t=l.uX;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[(0,_.sq)(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[(0,_.sq)(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(n.Z.ADD,this.boundAddFeature_),this.features_.addEventListener(n.Z.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(n.Z.ADD,this.boundAddFeature_),this.features_.removeEventListener(n.Z.REMOVE,this.boundRemoveFeature_))}addFeature_(e){let t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){let e=this.getMap().getAllLayers().find(function(e){if(e instanceof a.Z&&e.getSource()&&e.getSource().hasFeature(t))return e});e&&this.addFeatureLayerAssociation_(t,e)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){let t=(0,_.sq)(e);t in p||(p[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){let t=this.getMap().getInteractions().getArray();for(let i=t.length-1;i>=0;--i){let s=t[i];if(s!==this&&s instanceof y&&s.getStyle()&&-1!==s.getFeatures().getArray().lastIndexOf(e)){e.setStyle(s.getStyle());return}}let i=(0,_.sq)(e);e.setStyle(p[i]),delete p[i]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[_.sq(e)]}handleEvent(e){if(!this.condition_(e))return!0;let t=this.addCondition_(e),i=this.removeCondition_(e),s=this.toggleCondition_(e),n=e.map,r=this.getFeatures(),h=[],a=[];if(t||i||s){n.forEachFeatureAtPixel(e.pixel,(e,n)=>{if(e instanceof o.Z&&this.filter_(e,n))return(t||s)&&!r.getArray().includes(e)?(this.addFeatureLayerAssociation_(e,n),a.push(e)):(i||s)&&r.getArray().includes(e)&&(h.push(e),this.removeFeatureLayerAssociation_(e)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=h.length-1;e>=0;--e)r.remove(h[e]);r.extend(a)}else{(0,d.Z)(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,(e,t)=>{if(e instanceof o.Z&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),a.push(e),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=r.getLength()-1;e>=0;--e){let t=r.item(e),i=a.indexOf(t);i>-1?a.splice(i,1):(r.remove(t),h.push(t))}0!==a.length&&r.extend(a)}return(a.length>0||h.length>0)&&this.dispatchEvent(new m(f.SELECT,a,h,e)),!0}}t.Z=y},49674:function(e,t,i){i.d(t,{Z:function(){return v}});var s=i(35471),n=i(11192),r=i(27354),o=i(87988),h=i(24235),a=i(93040),l=i(82303);let d={SNAP:"snap"};class u extends l.ZP{constructor(e,t){super(e),this.vertex=t.vertex,this.vertexPixel=t.vertexPixel,this.feature=t.feature,this.segment=t.segment}}var g=i(75682),_=i(85810),c=i(87186),f=i(94027),m=i(92437),p=i(29342);function y(e){return e.feature?e.feature:e.element?e.element:null}let C=[];class x extends r.Z{constructor(e){let t=e=e||{};t.handleDownEvent||(t.handleDownEvent=a.uX),t.stopDown||(t.stopDown=a.Dv),super(t),this.on,this.once,this.un,this.source_=e.source?e.source:null,this.vertex_=void 0===e.vertex||e.vertex,this.edge_=void 0===e.edge||e.edge,this.features_=e.features?e.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.rBush_=new o.Z,this.GEOMETRY_SEGMENTERS_={Point:this.segmentPointGeometry_.bind(this),LineString:this.segmentLineStringGeometry_.bind(this),LinearRing:this.segmentLineStringGeometry_.bind(this),Polygon:this.segmentPolygonGeometry_.bind(this),MultiPoint:this.segmentMultiPointGeometry_.bind(this),MultiLineString:this.segmentMultiLineStringGeometry_.bind(this),MultiPolygon:this.segmentMultiPolygonGeometry_.bind(this),GeometryCollection:this.segmentGeometryCollectionGeometry_.bind(this),Circle:this.segmentCircleGeometry_.bind(this)}}addFeature(e,t){t=void 0===t||t;let i=(0,m.sq)(e),s=e.getGeometry();if(s){let t=this.GEOMETRY_SEGMENTERS_[s.getType()];if(t){this.indexedFeaturesExtents_[i]=s.getExtent((0,g.lJ)());let n=[];if(t(n,s),1===n.length)this.rBush_.insert((0,g.hI)(n[0]),{feature:e,segment:n[0]});else if(n.length>1){let t=n.map(e=>(0,g.hI)(e)),i=n.map(t=>({feature:e,segment:t}));this.rBush_.load(t,i)}}}t&&(this.featureChangeListenerKeys_[i]=(0,p.oL)(e,n.Z.CHANGE,this.handleFeatureChange_,this))}getFeatures_(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e}handleEvent(e){let t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel,this.dispatchEvent(new u(d.SNAP,{vertex:e.coordinate,vertexPixel:e.pixel,feature:t.feature,segment:t.segment}))),super.handleEvent(e)}handleFeatureAdd_(e){let t=y(e);t&&this.addFeature(t)}handleFeatureRemove_(e){let t=y(e);t&&this.removeFeature(t)}handleFeatureChange_(e){let t=e.target;if(this.handlingDownUpSequence){let e=(0,m.sq)(t);e in this.pendingFeatures_||(this.pendingFeatures_[e]=t)}else this.updateFeature_(t)}handleUpEvent(e){let t=Object.values(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}removeFeature(e,t){let i=(0,m.sq)(e),s=this.indexedFeaturesExtents_[i];if(s){let t=this.rBush_,i=[];t.forEachInExtent(s,function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])}(void 0===t||t)&&((0,p.bN)(this.featureChangeListenerKeys_[i]),delete this.featureChangeListenerKeys_[i])}setMap(e){let t=this.getMap(),i=this.featuresListenerKeys_,n=this.getFeatures_();t&&(i.forEach(p.bN),i.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(p.bN),this.featureChangeListenerKeys_={}),super.setMap(e),e&&(this.features_?i.push((0,p.oL)(this.features_,s.Z.ADD,this.handleFeatureAdd_,this),(0,p.oL)(this.features_,s.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,p.oL)(this.source_,h.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,p.oL)(this.source_,h.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),n.forEach(e=>this.addFeature(e)))}snapTo(e,t,i){let s,n;let r=i.getView().getProjection(),o=(0,f.Vs)(t,r),h=(0,f.Fj)((0,g.f3)((0,g.hI)([o]),i.getView().getResolution()*this.pixelTolerance_),r),a=this.rBush_.getInExtent(h),l=a.length;if(0===l)return null;let d=1/0,u=null,c=this.pixelTolerance_*this.pixelTolerance_,m=()=>{if(s){let t=i.getPixelFromCoordinate(s);if((0,_.bI)(e,t)<=c)return{vertex:s,vertexPixel:[Math.round(t[0]),Math.round(t[1])],feature:n,segment:u}}return null};if(this.vertex_){for(let e=0;e<l;++e){let t=a[e];"Circle"!==t.feature.getGeometry().getType()&&t.segment.forEach(e=>{let i=(0,f.Vs)(e,r),h=(0,_.bI)(o,i);h<d&&(s=e,d=h,n=t.feature)})}let e=m();if(e)return e}if(this.edge_){for(let e=0;e<l;++e){let t=null,i=a[e];if("Circle"===i.feature.getGeometry().getType()){let e=i.feature.getGeometry(),s=(0,f.Cs)();s&&(e=e.clone().transform(s,r)),t=(0,_.Ed)(o,e)}else{let[e,s]=i.segment;s&&(C[0]=(0,f.Vs)(e,r),C[1]=(0,f.Vs)(s,r),t=(0,_.oL)(o,C))}if(t){let e=(0,_.bI)(o,t);e<d&&(s=(0,f.lO)(t,r),u="Circle"===i.feature.getGeometry().getType()?null:i.segment,d=e)}}let e=m();if(e)return e}return null}updateFeature_(e){this.removeFeature(e,!1),this.addFeature(e,!1)}segmentCircleGeometry_(e,t){let i=this.getMap().getView().getProjection(),s=t,n=(0,f.Cs)();n&&(s=s.clone().transform(n,i));let r=(0,c.Bb)(s);n&&r.transform(i,n);let o=r.getCoordinates()[0];for(let t=0,i=o.length-1;t<i;++t)e.push(o.slice(t,t+2))}segmentGeometryCollectionGeometry_(e,t){let i=t.getGeometriesArray();for(let t=0;t<i.length;++t){let s=this.GEOMETRY_SEGMENTERS_[i[t].getType()];s&&s(e,i[t])}}segmentLineStringGeometry_(e,t){let i=t.getCoordinates();for(let t=0,s=i.length-1;t<s;++t)e.push(i.slice(t,t+2))}segmentMultiLineStringGeometry_(e,t){let i=t.getCoordinates();for(let t=0,s=i.length;t<s;++t){let s=i[t];for(let t=0,i=s.length-1;t<i;++t)e.push(s.slice(t,t+2))}}segmentMultiPointGeometry_(e,t){t.getCoordinates().forEach(t=>{e.push([t])})}segmentMultiPolygonGeometry_(e,t){let i=t.getCoordinates();for(let t=0,s=i.length;t<s;++t){let s=i[t];for(let t=0,i=s.length;t<i;++t){let i=s[t];for(let t=0,s=i.length-1;t<s;++t)e.push(i.slice(t,t+2))}}}segmentPointGeometry_(e,t){e.push([t.getCoordinates()])}segmentPolygonGeometry_(e,t){let i=t.getCoordinates();for(let t=0,s=i.length;t<s;++t){let s=i[t];for(let t=0,i=s.length-1;t<i;++t)e.push(s.slice(t,t+2))}}}var v=x}}]);